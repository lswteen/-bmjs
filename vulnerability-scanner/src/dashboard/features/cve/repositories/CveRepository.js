/**
 * CVE Repository
 * Data access layer for CVE operations
 * Abstracts database operations from business logic
 */
export class CveRepository {
    constructor(cveDb) {
        this.cveDb = cveDb;
    }

    /**
     * Check if CVE database is initialized
     * @returns {boolean}
     */
    isInitialized() {
        return this.cveDb.initialized;
    }

    /**
     * Search CVEs by filters
     * @param {Object} filters - Search filters
     * @param {number} page - Page number
     * @param {number} pageSize - Items per page
     * @returns {Promise<Object>}
     */
    async searchByFilters(filters, page, pageSize) {
        return await this.cveDb.searchByFilters(filters, page, pageSize);
    }

    /**
     * Get filter options for visualization
     * @returns {Promise<Object>}
     */
    async getFilterOptions() {
        return await this.cveDb.getFilterOptions();
    }

    /**
     * Get CVE data for visualization
     * @param {string} year - Year filter
     * @param {string} severity - Severity filter
     * @returns {Promise<Array>}
     */
    async getVisualData(year, severity) {
        return await this.cveDb.getVisualData(year, severity);
    }

    /**
     * Get detailed CVE list filtered by year and severity
     * @param {string} year - Year filter
     * @param {string} severity - Severity filter
     * @param {number} page - Page number
     * @param {number} pageSize - Items per page
     * @returns {Promise<Object>}
     */
    async getDetailedCveList(year, severity, page, pageSize) {
        return await this.cveDb.getDetailedCveList(year, severity, page, pageSize);
    }
}
