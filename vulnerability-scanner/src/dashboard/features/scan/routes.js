import { Router } from 'express';

/**
 * Scan Routes
 * Defines all vulnerability scanning endpoints
 */
export function createScanRoutes(scanController) {
    const router = Router();

    // Get latest scan results
    router.get('/results', (req, res) => scanController.getResults(req, res));

    // Trigger new scan
    router.post('/scan', (req, res) => scanController.triggerScan(req, res));

    // Get scan status
    router.get('/status', (req, res) => scanController.getStatus(req, res));

    // Get list of projects
    router.get('/projects', (req, res) => scanController.getProjects(req, res));

    // Get vulnerabilities for a specific project
    router.get('/projects/:projectKey/vulnerabilities', (req, res) =>
        scanController.getProjectVulnerabilities(req, res)
    );

    return router;
}
