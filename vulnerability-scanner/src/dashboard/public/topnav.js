function renderTopNav(activePage, extraActions = '') {
    const tabs = [
        { id: 'dashboards', label: 'DASHBOARDS', href: 'index.html' },
        { id: 'git', label: 'GITPROJECTS', href: 'gitprojects.html' },
        { id: 'treemap', label: 'PROJECT MAP', href: 'treemap.html' },
        { id: 'cve-explorer', label: 'EXPLORER', href: 'cve-explorer.html' },
        { id: 'cve-severity', label: 'SEVERITY', href: 'cve-severity.html' },
        { id: 'cve-product', label: 'PRODUCT', href: 'cve-product.html' }
    ];

    const tabsHtml = tabs.map(tab => {
        const isActive = (activePage === tab.id || (tab.id === 'git' && activePage === 'git-projects'));
        return `<a href="${tab.href}" class="tab-link ${isActive ? 'active' : ''}">${tab.label}</a>`;
    }).join('');

    const currentTheme = localStorage.getItem('theme') || 'light';
    const isChecked = currentTheme === 'dark' ? 'checked' : '';

    const headerHtml = `
        <div class="nav-tabs">
            ${tabsHtml}
        </div>
        <div class="header-actions">
            <!-- Theme Switcher -->
            <div class="theme-switch-wrapper">
                <span class="theme-icon">‚òÄÔ∏è</span>
                <label class="theme-switch" for="checkbox">
                    <input type="checkbox" id="checkbox" ${isChecked} />
                    <div class="slider round"></div>
                </label>
                <span class="theme-icon">üåô</span>
            </div>
            ${extraActions}
        </div>
    `;

    const container = document.getElementById('top-nav-container');
    if (container) {
        container.innerHTML = headerHtml;
        if (!container.classList.contains('top-nav')) {
            container.classList.add('top-nav');
        }

        // Add toggle listener
        const toggleSwitch = document.querySelector('.theme-switch input[type="checkbox"]');
        if (toggleSwitch) {
            toggleSwitch.addEventListener('change', switchTheme, false);
        }
    }
}

function switchTheme(e) {
    if (e.target.checked) {
        document.documentElement.setAttribute('data-theme', 'dark');
        localStorage.setItem('theme', 'dark');
    } else {
        document.documentElement.setAttribute('data-theme', 'light');
        localStorage.setItem('theme', 'light');
    }
}

// Initial theme setup (run before content renders if possible)
(function initTheme() {
    const currentTheme = localStorage.getItem('theme') || 'light';
    document.documentElement.setAttribute('data-theme', currentTheme);
})();
