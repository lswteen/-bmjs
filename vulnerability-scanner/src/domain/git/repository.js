/**
 * Domain Entity representing a Git Repository
 */
export class GitRepository {
    constructor({ slug, id, name, description, projectKey }) {
        if (!slug) throw new Error('GitRepository slug is required');
        if (!projectKey) throw new Error('GitRepository projectKey is required');

        this.slug = slug;
        this.id = id;
        this.name = name || slug;
        this.description = description || '';
        this.projectKey = projectKey;
        this.lastSynced = null;
    }

    static fromDto(dto, projectKey) {
        return new GitRepository({
            slug: dto.slug,
            id: dto.id,
            name: dto.name,
            description: dto.description,
            projectKey: projectKey
        });
    }

    setLastSynced(date) {
        this.lastSynced = date instanceof Date ? date.toISOString() : date;
    }

    toJSON() {
        return {
            slug: this.slug,
            id: this.id,
            name: this.name,
            description: this.description,
            projectKey: this.projectKey,
            lastSynced: this.lastSynced
        };
    }
}
