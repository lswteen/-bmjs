#!/usr/bin/env node

import { Scanner } from './scanner.js';

/**
 * Main entry point for CLI
 */
async function main() {
    try {
        // Parse CLI arguments
        const args = process.argv.slice(2);
        const options = {};

        for (let i = 0; i < args.length; i++) {
            if (args[i] === '--cves' && args[i + 1]) {
                options.cveBasePath = args[i + 1];
                i++;
            } else if (args[i] === '--target' && args[i + 1]) {
                options.projectScanPath = args[i + 1];
                i++;
            } else if (args[i] === '--deep') {
                options.deepScan = true;
            } else if (args[i] === '--java-home' && args[i + 1]) {
                options.javaHome = args[i + 1];
                i++;
            }
        }

        if (options.cveBasePath) console.log(`ðŸ”§ Using Custom CVE Path: ${options.cveBasePath}`);
        if (options.projectScanPath) console.log(`ðŸ”§ Using Custom Target Path: ${options.projectScanPath}`);
        if (options.deepScan) console.log(`ðŸ”§ Deep Scan Mode: ENABLED (Transitive Dependencies)`);
        if (options.javaHome) console.log(`ðŸ”§ Using Custom JAVA_HOME: ${options.javaHome}`);

        const scanner = new Scanner(options);
        await scanner.scan();
        process.exit(0);
    } catch (error) {
        console.error('âŒ Error:', error.message);
        console.error(error.stack);
        process.exit(1);
    }
}

main();
